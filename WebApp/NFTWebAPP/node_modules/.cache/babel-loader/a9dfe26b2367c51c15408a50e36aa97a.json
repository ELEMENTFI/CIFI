{"ast":null,"code":"'use strict';\n\nconst TransformStream = require('readable-stream').Transform;\n\nconst PubsubMessage = require('./pubsub-message-utils');\n\nclass PubsubMessageStream extends TransformStream {\n  constructor(options) {\n    const opts = Object.assign(options || {}, {\n      objectMode: true\n    });\n    super(opts);\n  }\n\n  static from(inputStream, callback) {\n    let outputStream = inputStream.pipe(new PubsubMessageStream());\n    inputStream.on('end', () => outputStream.emit('end'));\n    callback(null, outputStream);\n  }\n\n  _transform(obj, enc, callback) {\n    // go-ipfs returns '{}' as the very first object atm, we skip that\n    if (Object.keys(obj).length === 0) {\n      return callback();\n    }\n\n    try {\n      const msg = PubsubMessage.deserialize(obj, 'base64');\n      this.push(msg);\n      callback();\n    } catch (err) {\n      return callback(err);\n    }\n  }\n\n}\n\nmodule.exports = PubsubMessageStream;","map":{"version":3,"sources":["C:/demoAlgo/smart-contracts/devrel/algosigner-react/CIFI/WebApp/NFTWebAPP/node_modules/ipfs-api/src/utils/pubsub-message-stream.js"],"names":["TransformStream","require","Transform","PubsubMessage","PubsubMessageStream","constructor","options","opts","Object","assign","objectMode","from","inputStream","callback","outputStream","pipe","on","emit","_transform","obj","enc","keys","length","msg","deserialize","push","err","module","exports"],"mappings":"AAAA;;AAEA,MAAMA,eAAe,GAAGC,OAAO,CAAC,iBAAD,CAAP,CAA2BC,SAAnD;;AACA,MAAMC,aAAa,GAAGF,OAAO,CAAC,wBAAD,CAA7B;;AAEA,MAAMG,mBAAN,SAAkCJ,eAAlC,CAAkD;AAChDK,EAAAA,WAAW,CAAEC,OAAF,EAAW;AACpB,UAAMC,IAAI,GAAGC,MAAM,CAACC,MAAP,CAAcH,OAAO,IAAI,EAAzB,EAA6B;AAAEI,MAAAA,UAAU,EAAE;AAAd,KAA7B,CAAb;AACA,UAAMH,IAAN;AACD;;AAEU,SAAJI,IAAI,CAAEC,WAAF,EAAeC,QAAf,EAAyB;AAClC,QAAIC,YAAY,GAAGF,WAAW,CAACG,IAAZ,CAAiB,IAAIX,mBAAJ,EAAjB,CAAnB;AACAQ,IAAAA,WAAW,CAACI,EAAZ,CAAe,KAAf,EAAsB,MAAMF,YAAY,CAACG,IAAb,CAAkB,KAAlB,CAA5B;AACAJ,IAAAA,QAAQ,CAAC,IAAD,EAAOC,YAAP,CAAR;AACD;;AAEDI,EAAAA,UAAU,CAAEC,GAAF,EAAOC,GAAP,EAAYP,QAAZ,EAAsB;AAC9B;AACA,QAAIL,MAAM,CAACa,IAAP,CAAYF,GAAZ,EAAiBG,MAAjB,KAA4B,CAAhC,EAAmC;AACjC,aAAOT,QAAQ,EAAf;AACD;;AAED,QAAI;AACF,YAAMU,GAAG,GAAGpB,aAAa,CAACqB,WAAd,CAA0BL,GAA1B,EAA+B,QAA/B,CAAZ;AACA,WAAKM,IAAL,CAAUF,GAAV;AACAV,MAAAA,QAAQ;AACT,KAJD,CAIE,OAAOa,GAAP,EAAY;AACZ,aAAOb,QAAQ,CAACa,GAAD,CAAf;AACD;AACF;;AAzB+C;;AA4BlDC,MAAM,CAACC,OAAP,GAAiBxB,mBAAjB","sourcesContent":["'use strict'\r\n\r\nconst TransformStream = require('readable-stream').Transform\r\nconst PubsubMessage = require('./pubsub-message-utils')\r\n\r\nclass PubsubMessageStream extends TransformStream {\r\n  constructor (options) {\r\n    const opts = Object.assign(options || {}, { objectMode: true })\r\n    super(opts)\r\n  }\r\n\r\n  static from (inputStream, callback) {\r\n    let outputStream = inputStream.pipe(new PubsubMessageStream())\r\n    inputStream.on('end', () => outputStream.emit('end'))\r\n    callback(null, outputStream)\r\n  }\r\n\r\n  _transform (obj, enc, callback) {\r\n    // go-ipfs returns '{}' as the very first object atm, we skip that\r\n    if (Object.keys(obj).length === 0) {\r\n      return callback()\r\n    }\r\n\r\n    try {\r\n      const msg = PubsubMessage.deserialize(obj, 'base64')\r\n      this.push(msg)\r\n      callback()\r\n    } catch (err) {\r\n      return callback(err)\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = PubsubMessageStream\r\n"]},"metadata":{},"sourceType":"script"}